<div class="form-container">
  <!-- Header -->
  <div class="form-header">
    <h1>ğŸ“š Yeni Kitap Ekle</h1>
    <p class="subtitle">KÃ¼tÃ¼phaneye yeni kitap eklemek iÃ§in formu doldurun</p>
  </div>

  <!-- Loading Data - ngIf kullanÄ±mÄ± -->
  <div *ngIf="!isDataLoaded" class="loading-section">
    <div class="loading-spinner">ğŸ”„</div>
    <p>Veriler yÃ¼kleniyor...</p>
    
    <!-- DetaylÄ± loading states - ngIf -->
    <div class="loading-details">
      <div *ngIf="authorsLoading" class="loading-item">
        ğŸ“ Yazarlar yÃ¼kleniyor...
      </div>
      <div *ngIf="categoriesLoading" class="loading-item">
        ğŸ“‚ Kategoriler yÃ¼kleniyor...
      </div>
    </div>
  </div>

  <!-- Main Form - ngIf ile koÅŸullu gÃ¶sterim -->
  <div *ngIf="isDataLoaded" class="form-content">
    
    <!-- Success Message - ngIf -->
    <div *ngIf="successMessage" class="alert success-alert">
      <span class="alert-icon">âœ…</span>
      <span class="alert-text">{{ successMessage }}</span>
    </div>

    <!-- Error Message - ngIf -->
    <div *ngIf="errorMessage" class="alert error-alert">
      <span class="alert-icon">âŒ</span>
      <span class="alert-text">{{ errorMessage }}</span>
    </div>

    <!-- Book Form -->
    <form (ngSubmit)="onSubmit()" #bookForm="ngForm" class="book-form">
      
      <!-- Kitap AdÄ± -->
      <div class="form-group">
        <label for="title">Kitap AdÄ± *</label>
        <input 
          id="title"
          type="text"
          [(ngModel)]="book.title"
          name="title"
          placeholder="Kitap adÄ±nÄ± girin"
          class="form-control"
          required
          #titleInput="ngModel">
        
        <!-- Field Error - ngIf ile validation -->
        <div *ngIf="titleInput.invalid && titleInput.touched" class="field-error">
          Kitap adÄ± gereklidir
        </div>
      </div>

      <!-- AÃ§Ä±klama -->
      <div class="form-group">
        <label for="description">AÃ§Ä±klama</label>
        <textarea 
          id="description"
          [(ngModel)]="book.description"
          name="description"
          placeholder="Kitap hakkÄ±nda kÄ±sa aÃ§Ä±klama (opsiyonel)"
          class="form-control textarea"
          rows="3"></textarea>
      </div>

      <!-- Sayfa SayÄ±sÄ± -->
      <div class="form-group">
        <label for="pages">Sayfa SayÄ±sÄ± *</label>
        <input 
          id="pages"
          type="number"
          [(ngModel)]="book.countofPage"
          name="pages"
          placeholder="Sayfa sayÄ±sÄ±nÄ± girin"
          class="form-control"
          min="1"
          required
          #pagesInput="ngModel">
        
        <!-- Field Error - ngIf ile validation -->
        <div *ngIf="pagesInput.invalid && pagesInput.touched" class="field-error">
          <span *ngIf="book.countofPage <= 0">Sayfa sayÄ±sÄ± 0'dan bÃ¼yÃ¼k olmalÄ±dÄ±r</span>
          <span *ngIf="book.countofPage == null">Sayfa sayÄ±sÄ± gereklidir</span>
        </div>
      </div>

      <!-- Yazar SeÃ§imi - ngFor kullanÄ±mÄ± -->
      <div class="form-group">
        <label for="author">Yazar *</label>
        <select 
          id="author"
          [(ngModel)]="book.authorId"
          name="author"
          class="form-control"
          required
          #authorInput="ngModel">
          
          <option value="0" disabled>Yazar seÃ§in</option>
          
          <!-- ngFor ile yazarlarÄ± listele -->
          <option *ngFor="let author of authors; let i = index" 
                  [value]="author.id">
            {{ i + 1 }}. {{ author.name }} {{ author.surname }} 
            ({{ author.yearofBirth }})
          </option>
        </select>
        
        <!-- Field Error - ngIf ile validation -->
        <div *ngIf="authorInput.invalid && authorInput.touched" class="field-error">
          Yazar seÃ§imi gereklidir
        </div>
      </div>

      <!-- Kategori SeÃ§imi - ngFor kullanÄ±mÄ± -->
      <div class="form-group">
        <label for="category">Kategori *</label>
        <select 
          id="category"
          [(ngModel)]="book.categoryId"
          name="category"
          class="form-control"
          required
          #categoryInput="ngModel">
          
          <option value="0" disabled>Kategori seÃ§in</option>
          
          <!-- ngFor ile kategorileri listele -->
          <option *ngFor="let category of categories; trackBy: trackByCategory" 
                  [value]="category.id">
            {{ category.name }}
          </option>
        </select>
        
        <!-- Field Error - ngIf ile validation -->
        <div *ngIf="categoryInput.invalid && categoryInput.touched" class="field-error">
          Kategori seÃ§imi gereklidir
        </div>
      </div>
      <!-- Resim YÃ¼kleme -->

      <input type="file" (change)="onFileSelected($event)" />
  <!-- Resim yÃ¼klendiyse Ã¶nizleme -->
  <img *ngIf="previewUrl" [src]="previewUrl" width="100" />
  <button type="submit">Kaydet</button>

      <!-- Form Actions -->
      <div class="form-actions">
        <button 
          type="submit"
          [disabled]="isSubmitting || !isFormValid()"
          class="btn btn-secondary">
          
          <!-- Loading state - ngIf -->
          <span *ngIf="isSubmitting" class="btn-loading">
            ğŸ”„ Kaydediliyor...
          </span>
          <span *ngIf="!isSubmitting">
            ğŸ’¾ KitabÄ± Kaydet
          </span>
        </button>

        <button 
          type="button"
          (click)="clearForm()"
          [disabled]="isSubmitting"
          class="btn btn-secondary">
          ğŸ—‘ï¸ Temizle
        </button>

        <button 
          type="button"
          (click)="goBack()"
          class="btn btn-outline">
          â† Geri DÃ¶n
        </button>
      </div>
    </form>
  </div>

  
</div> 